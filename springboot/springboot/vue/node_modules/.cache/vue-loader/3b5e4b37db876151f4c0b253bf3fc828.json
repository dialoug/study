{"remainingRequest":"C:\\Users\\Dicloug\\Desktop\\springboot\\springboot\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Dicloug\\Desktop\\springboot\\springboot\\vue\\src\\views\\doctor\\Deal.vue?vue&type=style&index=0&id=8241655c&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\Dicloug\\Desktop\\springboot\\springboot\\vue\\src\\views\\doctor\\Deal.vue","mtime":1700554591540},{"path":"C:\\Users\\Dicloug\\Desktop\\springboot\\springboot\\vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1698897685673},{"path":"C:\\Users\\Dicloug\\Desktop\\springboot\\springboot\\vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1698897686267},{"path":"C:\\Users\\Dicloug\\Desktop\\springboot\\springboot\\vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1698897685463},{"path":"C:\\Users\\Dicloug\\Desktop\\springboot\\springboot\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698897685620},{"path":"C:\\Users\\Dicloug\\Desktop\\springboot\\springboot\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1698897685313}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmhlYWRlckJnIHsNCiAgYmFja2dyb3VuZDogI2VlZSAhaW1wb3J0YW50Ow0KfQ0K"},{"version":3,"sources":["Deal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmUA;AACA;AACA","file":"Deal.vue","sourceRoot":"src/views/doctor","sourcesContent":["<template>\r\n  <div>\r\n    <el-card>\r\n      <el-form :inline=\"true\" :model=\"form\" class=\"form\" size=\"medium\">\r\n        <el-form-item label=\"挂号单:\">\r\n          <el-input v-model=\"form.id\" :disabled=\"true\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"患者名称:\">\r\n          <el-input v-model=\"form.patient.name\" :disabled=\"true\">\r\n<!--            <template v-slot=\"scope\">-->\r\n<!--              {{ scope.row.patient.name }}-->\r\n<!--            </template>-->\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"年龄:\">\r\n          <el-input v-model=\"form.patient.age\" :disabled=\"true\">\r\n<!--            <template v-slot=\"scope\">-->\r\n<!--              {{ scope.row.patient.age }}-->\r\n<!--            </template>-->\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"性别:\">\r\n          <el-input v-model=\"form.patient.gender\" :disabled=\"true\">\r\n<!--            <template v-slot=\"scope\">-->\r\n<!--              {{ scope.row.patient.gender }}-->\r\n<!--            </template>-->\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item v-model=\"form.patient.phone\" label=\"联系方式:\">\r\n          <el-input :disabled=\"true\">\r\n<!--            <template v-slot=\"scope\">-->\r\n<!--              {{ scope.row.patient.phone }}-->\r\n<!--            </template>-->\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item style=\"text-align:center;\">\r\n          <el-button type=\"primary\" @click=\"save\">提交</el-button>\r\n          <el-button type=\"primary\" @click=\"handleEdit\">病因填写</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n      <el-dialog title=\"报告\" :visible.sync=\"dialogFormVisible\" width=\"50%\">\r\n        <el-form :label-position=\"'top'\" label-width=\"80px\" size=\"small\">\r\n          <el-form-item label=\"病因\">\r\n            <el-input type=\"textarea\" :rows=\"5\" v-model=\"form.etiology\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"建议\">\r\n            <el-input type=\"textarea\" :rows=\"5\" v-model=\"form.advice\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"handleSave\">确 定</el-button>\r\n        </div>\r\n      </el-dialog>\r\n\r\n      <el-row>\r\n        <div>\r\n<!--          分一列-->\r\n          <el-col :span=\"24\">\r\n            <div style=\"margin: 10px 0\">\r\n              <el-input style=\"width: 200px\" placeholder=\"请输入名称\" suffix-icon=\"el-icon-search\"\r\n                        v-model=\"drugName\"></el-input>\r\n              <el-button class=\"ml-5\" type=\"primary\" @click=\"drugPage\">搜索</el-button>\r\n              <el-button type=\"warning\" @click=\"resetDrug\">重置</el-button>\r\n            </div>\r\n          </el-col>\r\n<!--          分两列-->\r\n          <el-col :span=\"12\">\r\n            <el-table :data=\"drugData\" border stripe max-height=\"240\" :header-cell-class-name=\"'headerBg'\">\r\n              <el-table-column prop=\"name\" label=\"名称\"></el-table-column>\r\n              <el-table-column prop=\"number\" label=\"数量\"></el-table-column>\r\n              <el-table-column prop=\"unit\" label=\"单位\"></el-table-column>\r\n              <el-table-column prop=\"price\" label=\"价格\"></el-table-column>\r\n              <el-table-column label=\"操作\" width=\"280\" align=\"center\">\r\n                <template v-slot=\"scope\">\r\n                  <el-button type=\"success\" v-if=\"scope.row.number > 0\" @click=\"appendDrug(scope.row)\"><i\r\n                      class=\"el-icon-circle-plus-outline\"></i> 增加\r\n                  </el-button>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n            <div style=\"padding: 10px 0\">\r\n              <el-pagination\r\n                  @size-change=\"handleDrugSizeChange\"\r\n                  @current-change=\"handleDrugCurrentChange\"\r\n                  :current-page=\"drugPageNum\"\r\n                  :page-sizes=\"[2, 4, 8, 10]\"\r\n                  :page-size=\"drugPageSize\"\r\n                  layout=\"total, sizes, prev, pager, next, jumper\"\r\n                  :total=\"drugTotal\">\r\n              </el-pagination>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-table :data=\"drugList\" border stripe max-height=\"200\" :header-cell-class-name=\"'headerBg'\">\r\n              <el-table-column prop=\"name\" label=\"名称\"></el-table-column>\r\n              <el-table-column prop=\"number\" label=\"数量\"></el-table-column>\r\n              <el-table-column prop=\"price\" label=\"价格\"></el-table-column>\r\n              <el-table-column prop=\"total\" label=\"小计\"></el-table-column>\r\n              <el-table-column label=\"操作\" width=\"280\" align=\"center\">\r\n                <template v-slot=\"scope\">\r\n                  <el-button type=\"danger\" @click=\"removeDrug(scope.row)\"><i class=\"el-icon-delete\"></i> 移除\r\n                  </el-button>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n            <div style=\"text-align:center;margin-top: 10px;\">\r\n              <el-tag>\r\n                总计: {{ drugTotalPrice }}元\r\n              </el-tag>\r\n            </div>\r\n          </el-col>\r\n        </div>\r\n        <div>\r\n          <el-col :span=\"24\">\r\n            <div style=\"margin: 10px 0\">\r\n              <el-input style=\"width: 200px\" placeholder=\"请输入名称\" suffix-icon=\"el-icon-search\"\r\n                        v-model=\"checksName\"></el-input>\r\n              <el-button class=\"ml-5\" type=\"primary\" @click=\"checksPage\">搜索</el-button>\r\n              <el-button type=\"warning\" @click=\"resetChecks\">重置</el-button>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-table :data=\"checksData\" border stripe max-height=\"240\" :header-cell-class-name=\"'headerBg'\">\r\n              <el-table-column prop=\"name\" label=\"名称\"></el-table-column>\r\n              <el-table-column prop=\"price\" label=\"价格\"></el-table-column>\r\n              <el-table-column label=\"操作\" width=\"280\" align=\"center\">\r\n                <template v-slot=\"scope\">\r\n                  <el-button type=\"success\" @click=\"appendChecks(scope.row)\"><i\r\n                      class=\"el-icon-circle-plus-outline\"></i> 增加\r\n                  </el-button>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n            <div style=\"padding: 10px 0\">\r\n              <el-pagination\r\n                  @size-change=\"handleChecksSizeChange\"\r\n                  @current-change=\"handleChecksCurrentChange\"\r\n                  :current-page=\"checksPageNum\"\r\n                  :page-sizes=\"[2, 4, 8, 10]\"\r\n                  :page-size=\"checksPageSize\"\r\n                  layout=\"total, sizes, prev, pager, next, jumper\"\r\n                  :total=\"checksTotal\">\r\n              </el-pagination>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-table :data=\"checksList\" border stripe max-height=\"200\" :header-cell-class-name=\"'headerBg'\">\r\n              <el-table-column prop=\"name\" label=\"名称\"></el-table-column>\r\n              <el-table-column prop=\"price\" label=\"价格\"></el-table-column>\r\n              <el-table-column label=\"操作\" width=\"280\" align=\"center\">\r\n                <template v-slot=\"scope\">\r\n                  <el-button type=\"danger\" @click=\"removeChecks(scope.row)\"><i class=\"el-icon-delete\"></i> 移除\r\n                  </el-button>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n            <div style=\"text-align:center;margin-top: 10px;\">\r\n              <el-tag>\r\n                总计: {{ checksTotalPrice }}元\r\n              </el-tag>\r\n            </div>\r\n          </el-col>\r\n        </div>\r\n      </el-row>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Deal\",\r\n  data() {\r\n    return {\r\n      form: this.$route.params.patient,\r\n      drugData: [],  // 全部药品\r\n      drugList: [],  // 所选药品\r\n      drugTotalPrice: 0,  // 所选药品总价\r\n      drugTotal: 0,  // 药品种类数目\r\n      drugPageNum: 1,  //\r\n      drugPageSize: 4,\r\n      drugName: \"\",\r\n      checksData: [],  // 全部检查\r\n      checksList: [],  // 所选检查\r\n      checksTotalPrice: 0,  // 所选检查总价\r\n      checksTotal: 0,  // 检查种类数目\r\n      checksPageNum: 1,\r\n      checksPageSize: 4,\r\n      checksName: \"\",\r\n      dialogFormVisible: false,\r\n    }\r\n  },\r\n  created() {\r\n    this.drugPage()\r\n    this.checksPage()\r\n    console.log()\r\n  },\r\n  methods: {\r\n    drugPage() {\r\n      this.request.get('/drug/page', {\r\n        params: {\r\n          pageNum: this.drugPageNum,\r\n          pageSize: this.drugPageSize,\r\n          name: this.drugName\r\n        }\r\n      }).then(res => {\r\n        this.drugData = res.data.records\r\n        this.drugTotal = res.data.total\r\n      })\r\n    },\r\n    resetDrug() {\r\n      this.drugName = \"\"\r\n      this.drugPage()\r\n    },\r\n    // 选择每页药品条数\r\n    handleDrugSizeChange(pageSize) {\r\n      this.drugPageSize = pageSize\r\n      this.drugPage()\r\n    },\r\n    // 选择药品页码\r\n    handleDrugCurrentChange(pageNum) {\r\n      this.drugPageNum = pageNum\r\n      this.drugPage()\r\n    },\r\n    appendDrug(row) {\r\n      let drug = this.drugList.find(v => v.id === row.id)\r\n      if (!drug) {  // 如果是新增药品\r\n        let temp = JSON.parse(JSON.stringify(row))  // 复制一份药品库中指定药品的信息\r\n        temp.total = row.price\r\n        temp.number = 1\r\n        this.drugList.push(temp)\r\n        row.number -= 1\r\n      } else {  // 如果是增加数量\r\n        drug.number += 1\r\n        drug.total = drug.total + drug.price\r\n        row.number -= 1\r\n      }\r\n      this.drugTotalPrice = 0\r\n      this.drugList.forEach(v => {\r\n        this.drugTotalPrice += v.total\r\n      })\r\n    },\r\n    removeDrug(row) {\r\n      this.drugList.splice(this.drugList.indexOf(row), 1)\r\n      this.drugTotalPrice -= row.total\r\n      this.drugData.find(v => v.id === row.id).number += row.number\r\n    },\r\n    // 检查单\r\n    checksPage() {\r\n      this.request.get('/checks/page', {\r\n        params: {\r\n          pageNum: this.checksPageNum,\r\n          pageSize: this.checksPageSize,\r\n          name: this.checksName\r\n        }\r\n      }).then(res => {\r\n        this.checksData = res.data.records\r\n        this.checksTotal = res.data.total\r\n      })\r\n    },\r\n    resetChecks() {\r\n      this.checksName = \"\"\r\n      this.checksPage()\r\n    },\r\n    handleChecksSizeChange(pageSize) {\r\n      this.checksPageSize = pageSize\r\n      this.checksPage()\r\n    },\r\n    handleChecksCurrentChange(pageNum) {\r\n      this.checksPageNum = pageNum\r\n      this.checksPage()\r\n    },\r\n    appendChecks(row) {\r\n      this.checksList.push(row)\r\n      this.checksTotalPrice = 0\r\n      this.checksList.forEach(v => {\r\n        this.checksTotalPrice += v.price\r\n      })\r\n    },\r\n    removeChecks(row) {\r\n      this.checksList.splice(this.checksList.indexOf(row), 1)\r\n      this.checksTotalPrice -= row.price\r\n    },\r\n    save() {\r\n      if (this.drugList.length > 0) {\r\n        this.form.drug = ''\r\n        this.drugList.forEach(v => {\r\n          this.form.drug += v.name + '*' + v.price + '*' + v.number + ' '\r\n        })\r\n        this.form.drug += ' 药物总价' + this.drugTotalPrice + '元'\r\n      }\r\n\r\n      if (this.checksList.length > 0) {\r\n        this.form.checks = ''\r\n        this.checksList.forEach(v => {\r\n          this.form.checks += v.name + '*' + v.price + ' '\r\n        })\r\n        this.form.checks += ' 项目总价' + this.checksTotalPrice + '元'\r\n      }\r\n      this.form.totalPrice = this.checksTotalPrice + this.drugTotalPrice\r\n      this.form.state = '1'\r\n      this.request.post('/registration/edit', this.form).then(res => {\r\n        if (res.code === '200') {\r\n          this.$message.success('提交成功! 请通知患者登录系统自助缴费！')\r\n          this.$router.push('/registerToday')\r\n        }\r\n      })\r\n\r\n    },\r\n    handleSave() {\r\n      this.dialogFormVisible = false\r\n      this.$message.success('信息保存成功')\r\n    },\r\n    handleEdit() {\r\n      this.form.etiology = ''\r\n      this.form.advice = ''\r\n      this.dialogFormVisible = true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.headerBg {\r\n  background: #eee !important;\r\n}\r\n</style>"]}]}